# ccLoad Docker 环境配置示例
# 复制此文件为 .env 并根据需要修改配置

# ========================================
# 核心配置（必需）
# ========================================

# 管理后台密码（必需，未设置将导致程序退出）
CCLOAD_PASS=your_secure_admin_password

# API 访问令牌（必需，多个令牌用逗号分隔；访问 /v1/* 与 /v1beta/* 必须设置，否则返回 401）
CCLOAD_AUTH=token1,token2,token3

# ========================================
# 数据库配置
# ========================================

# 数据库文件路径（容器内路径，通常不需要修改）
SQLITE_PATH=/app/data/ccload.db

# 主数据库内存模式（可选，默认: false）
# 启用后性能提升 50-100 倍，但重启后数据丢失
# Docker 环境下建议配合 Redis 同步或数据卷持久化
# CCLOAD_USE_MEMORY_DB=true

# SQLite Journal 模式（可选，默认: WAL）
# 可选值: WAL | DELETE | TRUNCATE | PERSIST | MEMORY | OFF
# - WAL（默认）：Write-Ahead Logging，高性能，适合本地文件系统
# - TRUNCATE：传统回滚日志，适合 Docker/K8s 环境或网络存储（NFS等）
# - DELETE：与 TRUNCATE 类似，但删除日志文件而非截断
# ⚠️ 容器环境建议：SQLITE_JOURNAL_MODE=TRUNCATE（避免WAL文件损坏风险）
# SQLITE_JOURNAL_MODE=TRUNCATE

# ========================================
# 网络配置
# ========================================

# HTTP 服务端口（容器内端口，通常不需要修改）
PORT=8080

# TLS 证书验证（可选，默认: false）
# 仅开发环境使用，生产环境严禁禁用 TLS 验证
# CCLOAD_SKIP_TLS_VERIFY=true

# ========================================
# 性能优化配置
# ========================================

# 单个渠道内最大 Key 重试次数（可选，默认: 3）
# CCLOAD_MAX_KEY_RETRIES=3

# 最大并发请求数（可选，默认: 1000）
# 限制同时处理的代理请求数量，防止goroutine爆炸
# CCLOAD_MAX_CONCURRENCY=1000

# 请求体最大字节数（可选，默认: 2097152，即 2MB）
# 限制单个API请求体的大小，防止大包打爆内存
# CCLOAD_MAX_BODY_BYTES=2097152

# 上游首字节超时（可选，单位: 秒，默认: 不设置）
# 设置后，如果上游API在指定时间内未返回首字节，则请求超时
# CCLOAD_UPSTREAM_FIRST_BYTE_TIMEOUT=30

# 启用启动预热（可选，默认: false）
# 启用后在服务启动时预热HTTP连接，消除首次请求的TLS握手延迟（10-50ms）
# CCLOAD_ENABLE_WARMUP=true

# ========================================
# Redis 同步配置（推荐）
# ========================================

# Redis 连接 URL（推荐配置，用于渠道数据同步）
# Docker Compose 环境下可使用服务名
# REDIS_URL=redis://redis:6379

# ========================================
# 运行模式配置
# ========================================

# Gin 运行模式（release/debug）
GIN_MODE=release
