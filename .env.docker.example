# ccLoad Docker 环境配置示例
# 复制此文件为 .env 并根据需要修改配置

# ========================================
# 核心配置（必需）
# ========================================

# 管理后台密码（必需，未设置将导致程序退出）
CCLOAD_PASS=your_secure_admin_password

# API 访问令牌通过 Web 管理界面动态配置
# 访问 http://localhost:8080/web/tokens.html 进行令牌管理

# ========================================
# 数据库配置
# ========================================

# 数据库文件路径（容器内路径，通常不需要修改）
SQLITE_PATH=/app/data/ccload.db

# MySQL DSN（可选，设置后启用 MySQL 存储）
# 格式: user:password@tcp(host:port)/dbname?charset=utf8mb4&parseTime=True&loc=Local
# 示例: CCLOAD_MYSQL=root:password@tcp(mysql:3306)/ccload?charset=utf8mb4&parseTime=True&loc=Local

# 混合存储模式（可选，默认: 0）
# 需要同时设置 CCLOAD_MYSQL 和此变量为 1
# 混合模式：MySQL 作为主存储，SQLite 作为本地缓存（适用于 HuggingFace Spaces 等场景）
# CCLOAD_ENABLE_SQLITE_REPLICA=1

# 混合模式日志恢复天数（可选，默认: 7）
# 启动时从 MySQL 恢复多少天的日志到 SQLite
# -1=全量恢复，0=不恢复日志
# CCLOAD_SQLITE_LOG_DAYS=7

# SQLite Journal 模式（可选，默认: WAL）
# 可选值: WAL | DELETE | TRUNCATE | PERSIST | MEMORY | OFF
# - WAL（默认）：Write-Ahead Logging，高性能，适合本地文件系统
# - TRUNCATE：传统回滚日志，适合 Docker/K8s 环境或网络存储（NFS等）
# - DELETE：与 TRUNCATE 类似，但删除日志文件而非截断
# ⚠️ 容器环境建议：SQLITE_JOURNAL_MODE=TRUNCATE（避免WAL文件损坏风险）
# SQLITE_JOURNAL_MODE=TRUNCATE

# ========================================
# 网络配置
# ========================================

# HTTP 服务端口（容器内端口，通常不需要修改）
PORT=8080

# ========================================
# 安全配置
# ========================================

# 禁用上游 TLS 证书校验（可选，默认: 0）
# ⚠️ 仅用于临时排障或受控内网环境，生产环境严禁启用
# CCLOAD_ALLOW_INSECURE_TLS=0

# ========================================
# 性能优化配置
# ========================================

# 最大并发请求数（可选，默认: 1000）
# 限制同时处理的代理请求数量，防止goroutine爆炸
# CCLOAD_MAX_CONCURRENCY=1000

# 请求体最大字节数（可选，默认: 10485760，即 10MB）
# 限制单个API请求体的大小，防止大包打爆内存
# CCLOAD_MAX_BODY_BYTES=10485760

# ========================================
# 运行模式配置
# ========================================

# Gin 运行模式（release/debug）
GIN_MODE=release

# ========================================
# 系统配置（已迁移到 Web 管理界面）
# ========================================
# 以下配置项已迁移到数据库，通过 Web 界面管理，支持热重载：
# - 日志保留天数 (log_retention_days)
# - 单渠道最大Key重试次数 (max_key_retries)
# - 上游首字节超时 (upstream_first_byte_timeout)
#
# 访问 http://localhost:8080/web/settings.html 进行配置管理
