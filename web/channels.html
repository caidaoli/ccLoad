<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" type="image/x-icon" href="/web/favicon.ico">
  <link rel="apple-touch-icon" href="/web/apple-touch-icon.png">
  <link rel="manifest" href="/web/manifest.json">
  <meta name="theme-color" content="#3b82f6">
  <title>渠道管理 - Claude Code & Codex Proxy</title>
  <link rel="stylesheet" href="/web/assets/css/styles.css">
  <link href="/web/assets/css/inter.css" rel="stylesheet">
  <link rel="stylesheet" href="/web/assets/css/channels.css">
</head>
<body>
  <div class="app-container">
    <main class="main-content">
      <div class="content-area">
        <header class="mb-2">
        </header>
        <header class="mb-4">
          <div class="glass-card animate-slide-up" style="padding: var(--space-6);">
            <div style="display: flex; align-items: center; justify-content: space-between; gap: 16px; flex-wrap: wrap;">
              <p class="page-subtitle" style="margin: 0;">配置API渠道、优先级和模型支持（<b>优先请求高优先级渠道，相同优先级则轮询调用</b>）</p>
              <div style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
                <button id="exportCsvBtn" type="button" class="btn btn-secondary" style="padding: 8px 16px; font-size: 14px;" title="导出渠道列表为CSV">
                  导出 CSV
                </button>
                <button id="importCsvBtn" type="button" class="btn btn-secondary" style="padding: 8px 16px; font-size: 14px;" title="从CSV导入渠道">
                  导入 CSV
                </button>
                <button onclick="showAddModal()" type="button" class="btn btn-primary" style="padding: 8px 16px; font-size: 14px;" title="添加新渠道">
                  + 添加渠道
                </button>
                <input type="file" id="importCsvInput" accept=".csv" style="display: none;" />
              </div>
            </div>
          </div>
        </header>

        <!-- Filter Bar -->
        <div class="filter-bar">
          <div class="filter-controls">
           

            <div class="">
              <label class="filter-label">渠道ID</label>
              <input type="text" id="idFilter" class="filter-input" placeholder="输入ID..." style="max-width: 100px;">
            </div>

            <div class="filter-group">
              <label class="filter-label">渠道类型</label>
              <select id="channelTypeFilter" class="filter-select" style="min-width: 100px;">
                <!-- 动态加载渠道类型 -->
              </select>
            </div>

            <div class="filter-group">
              <label class="filter-label">状态</label>
              <select id="statusFilter" class="filter-select" style="min-width: 100px;">
                <option value="all">所有状态</option>
                <option value="enabled">已启用</option>
                <option value="disabled">已禁用</option>
                <option value="cooldown">冷却中</option>
              </select>
            </div>

            <div class="filter-group">
              <label class="filter-label">模型</label>
              <select id="modelFilter" class="filter-select" style="min-width: 100px;">
                <option value="all">所有模型</option>
              </select>
            </div>
             <div class="filter-group">
              <label class="filter-label">搜索渠道</label>
              <div style="position: relative; flex: 1; min-width: 140px;">
                <input type="text" id="searchInput" class="filter-input" placeholder="输入渠道名称..." style="padding-right: 36px;">
                <button id="clearSearchBtn" type="button" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; color: var(--neutral-500); cursor: pointer; font-size: 14px; padding: 2px; opacity: 0; transition: opacity 0.2s; border-radius: 3px;" title="清空搜索" onmouseover="this.style.background='var(--neutral-100)'" onmouseout="this.style.background='none'">
                  ✕
                </button>
              </div>
            </div>
            <div class="filter-info" id="filterInfo"><span id="filteredCount">0</span> / <span id="totalCount">0</span> 个渠道
            </div>

            <div style="flex: none;">
              <button id="resetFiltersBtn" type="button" class="btn btn-primary" style="padding: 8px 16px; font-size: 14px;" title="重置所有筛选条件">
                重置
              </button>
            </div>
          </div>
        </div>

        <section>
          <div id="channels-container" class="grid grid-cols-1 gap-6"></div>
        </section>
      </div>
    </main>
  </div>

  <!-- 添加/编辑渠道模态框 -->
  <div id="channelModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">添加渠道</h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <form id="channelForm" onsubmit="saveChannel(event)">
        <div class="form-group">
          <!-- 渠道名称、类型和策略全部在一行 -->
          <div style="display: flex; gap: 12px; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 8px; flex: 0 0 auto;">
              <label class="form-label" style="margin: 0; white-space: nowrap;">渠道名称 *</label>
              <input type="text" id="channelName" class="form-input" required style="width: 200px;">
            </div>

            <div style="display: flex; align-items: center; gap: 20px;">
              <div style="display: flex; align-items: center; gap: 8px;">
                <label style="margin: 0; font-size: 13px; white-space: nowrap; color: var(--neutral-700);">渠道类型 *</label>
                <div style="display: flex; gap: 12px;" id="channelTypeRadios">
                  <!-- 动态加载渠道类型 -->
                </div>
              </div>

              <div style="display: flex; align-items: center; gap: 8px;">
                <label style="margin: 0; font-size: 13px; white-space: nowrap; color: var(--neutral-700);">Key策略</label>
                <div style="display: flex; gap: 12px;" id="keyStrategyRadios">
                  <label style="display: flex; align-items: center; gap: 4px; cursor: pointer; font-size: 13px;">
                    <input type="radio" name="keyStrategy" value="sequential" checked>
                    <span>顺序</span>
                  </label>
                  <label style="display: flex; align-items: center; gap: 4px; cursor: pointer; font-size: 13px;">
                    <input type="radio" name="keyStrategy" value="round_robin">
                    <span>轮询</span>
                  </label>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <div style="display: flex; align-items: center; gap: 8px;">
          <label class="form-label" for="channelUrl">API URL *</label>
          <input type="url" id="channelUrl" class="form-input" placeholder="https://api.anthropic.com/v1/messages" required style="flex: 1;">
          </div>
        </div>

        <div class="form-group">
          <!-- API Key标签行：包含标签、Key计数和操作按钮 -->
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <label class="form-label" style="margin: 0;">
              API Key * <span class="models-hint" style="margin-left: 8px; margin-top: 0;">共 <span id="inlineKeyCount">0</span> 个Key <span id="virtualScrollHint" style="display: none; color: var(--primary-600); font-weight: 600;">· 虚拟滚动已启用</span></span>
            </label>
            <div style="display: flex; gap: 6px;">
              <button type="button" class="btn btn-secondary btn-sm" onclick="openInlineKeyImport()" style="padding: 5px 10px; font-size: 12px; display: inline-flex; align-items: center; gap: 4px;">
                <svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8 3.5V12M8 12L5 9M8 12L11 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M2 13.5H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
                <span>导入</span>
              </button>
              <button type="button" id="toggleInlineKeyBtn" onclick="toggleInlineKeyVisibility()" style="width: 26px; height: 26px; border-radius: 6px; border: 1px solid var(--neutral-300); background: white; color: var(--neutral-500); cursor: pointer; padding: 0; display: inline-flex; align-items: center; justify-content: center; transition: all 0.2s;" title="显示/隐藏API Key" onmouseover="this.style.background='var(--neutral-50)'; this.style.borderColor='var(--neutral-400)';" onmouseout="this.style.background='white'; this.style.borderColor='var(--neutral-300)';">
                <svg id="inlineEyeIcon" width="13" height="13" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1.5 8C1.5 8 3.5 3.5 8 3.5C12.5 3.5 14.5 8 14.5 8C14.5 8 12.5 12.5 8 12.5C3.5 12.5 1.5 8 1.5 8Z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                  <circle cx="8" cy="8" r="2" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <svg id="inlineEyeOffIcon" width="13" height="13" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                  <path d="M2 2L14 14M6.5 6.5C6.96785 6.03214 7.60786 5.75 8.3 5.75C9.73071 5.75 10.9 6.91929 10.9 8.35C10.9 9.04214 10.6179 9.68215 10.15 10.15M4.5 4.5C2.73 5.67 1.5 8 1.5 8C1.5 8 3.5 12.5 8 12.5C9.35 12.5 10.58 11.97 11.55 11.5M12.85 11.85C13.97 10.73 14.5 8 14.5 8C14.5 8 12.5 3.5 8 3.5C7.23 3.5 6.5 3.73 5.85 4.05" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- 隐藏的input用于表单验证和提交 -->
          <input type="hidden" id="channelApiKey" required>

          <!-- Key表格容器（最多显示5行+滚动） -->
          <div style="max-height: 250px; overflow-y: auto; border: 1px solid var(--neutral-200); border-radius: 8px; background: white;">
            <table style="width: 100%; border-collapse: collapse;">
              <thead style="position: sticky; top: 0; z-index: 1; background: var(--neutral-100);">
                <tr style="border-bottom: 2px solid var(--neutral-300);">
                  <th style="padding: 6px 10px; text-align: left; font-weight: 600; font-size: 13px; width: 70px;">
                    <div style="display: flex; align-items: center; gap: 6px;">
                      <input
                        type="checkbox"
                        id="selectAllKeys"
                        onchange="toggleSelectAllKeys(this.checked)"
                        style="width: 16px; height: 16px; cursor: pointer; accent-color: var(--primary-500);"
                        title="全选/取消全选"
                      >
                      <span>#</span>
                    </div>
                  </th>
                  <th style="padding: 6px 10px; text-align: left; font-weight: 600; font-size: 13px;">API Key</th>
                  <th style="padding: 6px 10px; text-align: left; font-weight: 600; font-size: 13px; width: 200px;">
                    <select
                      id="keyStatusFilter"
                      onchange="filterKeysByStatus(this.value)"
                      style="width: 100%; padding: 4px 8px; border: 1px solid var(--neutral-300); border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; background: white;"
                    >
                      <option value="all">全部</option>
                      <option value="normal">正常</option>
                      <option value="cooldown">冷却中</option>
                    </select>
                  </th>
                  <th style="padding: 6px 10px; text-align: center; font-weight: 600; font-size: 13px; width: 120px;">
                    <button
                      type="button"
                      id="batchDeleteKeysBtn"
                      onclick="batchDeleteSelectedKeys()"
                      disabled
                      title="批量删除选中的Keys"
                      style="padding: 4px 12px; border-radius: 6px; border: 1px solid var(--neutral-300); background: white; color: var(--neutral-500); cursor: not-allowed; font-size: 12px; font-weight: 500; transition: all 0.2s;"
                    >
                      删除选中
                    </button>
                  </th>
                </tr>
              </thead>
              <tbody id="inlineKeyTableBody">
                <!-- Key行动态渲染 -->
              </tbody>
            </table>
          </div>
        </div>
        <div class="form-group">
          <!-- 标签行：包含标签和操作按钮 -->
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <label class="form-label" style="margin: 0;">
              支持的模型 * <span class="models-hint" style="margin-left: 8px; margin-top: 0;">多个模型用英文逗号分隔</span>
            </label>
            <div style="display: flex; gap: 6px;">
              <button type="button" class="btn btn-secondary btn-sm" onclick="fetchModelsFromAPI()" style="padding: 5px 10px; font-size: 12px; display: inline-flex; align-items: center; gap: 4px;" title="从渠道API获取可用模型列表">
                <svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0 3.58 0 8s3.58 8 8 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/>
                </svg>
                <span>获取模型列表</span>
              </button>
              <button type="button" class="btn btn-secondary btn-sm" onclick="clearAllModels()" style="padding: 5px 10px; font-size: 12px; display: inline-flex; align-items: center; gap: 4px;" title="清除所有模型">
                <svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M5.5 2.5V1.5C5.5 1.22386 5.72386 1 6 1H10C10.2761 1 10.5 1.22386 10.5 1.5V2.5M2 3.5H14M3 3.5V13.5C3 14.0523 3.44772 14.5 4 14.5H12C12.5523 14.5 13 14.0523 13 13.5V3.5" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>清除所有</span>
              </button>
            </div>
          </div>
          <textarea id="channelModels" class="form-input" placeholder="claude-3-5-sonnet-20241022,claude-3-opus-20240229" required rows="2"></textarea>
        </div>
        <div class="form-group">
          <!-- 模型重定向标签行：包含标签和操作按钮 -->
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <label class="form-label" style="margin: 0;">
              模型重定向（可选） <span class="models-hint" style="margin-left: 8px; margin-top: 0;">将请求模型映射到实际转发模型，共 <span id="redirectCount">0</span> 条规则</span>
            </label>
            <div style="display: flex; gap: 6px;">
              <button type="button" class="btn btn-secondary btn-sm" onclick="addRedirectRow()" style="padding: 5px 10px; font-size: 12px; display: inline-flex; align-items: center; gap: 4px;" title="添加模型重定向规则">
                <svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8 3.5V12.5M3.5 8H12.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span>添加</span>
              </button>
            </div>
          </div>

          <!-- 重定向表格容器 -->
          <div style="max-height: 300px; overflow-y: auto; border: 1px solid var(--neutral-200); border-radius: 8px; background: white;">
            <table style="width: 100%; border-collapse: collapse;">
              <thead style="position: sticky; top: 0; z-index: 1; background: var(--neutral-100);">
                <tr style="border-bottom: 2px solid var(--neutral-300);">
                  <th style="padding: 8px 12px; text-align: left; font-weight: 600; font-size: 13px; width: 45%;">请求模型</th>
                  <th style="padding: 8px 12px; text-align: left; font-weight: 600; font-size: 13px; width: 45%;">实际模型</th>
                  <th style="padding: 8px 12px; text-align: center; font-weight: 600; font-size: 13px; width: 10%;">操作</th>
                </tr>
              </thead>
              <tbody id="redirectTableBody">
                <!-- 重定向行动态渲染 -->
              </tbody>
            </table>
          </div>
        </div>
        <div class="form-group">
          <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
            <label class="form-label" style="margin: 0;">
              <input type="checkbox" id="channelEnabled" checked> 启用渠道
            </label>
            <div style="display: flex; align-items: center; gap: 8px;">
              <label class="form-label" for="channelPriority" style="margin: 0; white-space: nowrap;">优先级</label>
              <input type="number" id="channelPriority" class="form-input" value="0" min="-99999" max="99999" style="width: 100px; min-width: 100px;">
            </div>
            <div style="margin-left: auto; display: flex; gap: 12px;">
              <button type="button" class="btn btn-secondary" onclick="closeModal()">取消</button>
              <button type="submit" class="btn btn-primary">保存</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- 删除确认模态框 -->
  <div id="deleteModal" class="modal">
    <div class="modal-content confirm-modal">
      <h2 class="modal-title">确认删除</h2>
      <p>确定要删除渠道 "<span id="deleteChannelName"></span>" 吗？</p>
      <p style="color: var(--error-600); font-size: 0.875rem;">此操作不可恢复！</p>
      <div class="confirm-actions">
        <button class="btn btn-secondary" onclick="closeDeleteModal()">取消</button>
        <button class="btn btn-danger" onclick="confirmDelete()">删除</button>
      </div>
    </div>
  </div>

  <!-- 测试渠道模态框 -->
  <div id="testModal" class="modal">
    <div class="modal-content test-modal-content">
      <div class="modal-header">
        <h2 class="modal-title">测试渠道 - <span id="testChannelName"></span></h2>
        <button class="close-btn" onclick="closeTestModal()">&times;</button>
      </div>
      <div class="form-group">
        <label class="form-label" for="testChannelType">渠道类型</label>
        <select id="testChannelType" class="form-input" onchange="updateTestURL()">
          <!-- 动态加载渠道类型 -->
        </select>
      </div>

      <div class="form-group">
        <label class="form-label" for="testModelSelect">选择测试模型</label>
        <select id="testModelSelect" class="model-select">
          <!-- 动态填充模型选项 -->
        </select>
      </div>

      <div class="form-group" id="testKeySelectGroup" style="display: none;">
        <label class="form-label" for="testKeySelect">
          选择 API Key
          <span class="models-hint" style="margin-left: 8px;">单次测试时使用的 Key（最多显示前10个）</span>
        </label>
        <select id="testKeySelect" class="form-input">
          <!-- 动态填充 Key 选项（限制前10个） -->
        </select>
      </div>

      <div class="form-group">
        <label class="form-label" for="testContentInput">测试内容</label>
        <textarea id="testContentInput" class="form-input" rows="3" placeholder="输入测试内容..." style="resize: vertical; min-height: 80px;"></textarea>
        <div class="models-hint">默认内容从系统设置加载，可在"系统设置"页面修改</div>
      </div>

      <div class="form-group">
        <label class="form-label" style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
          <input type="checkbox" id="testStreamEnabled" checked style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--primary-500);">
          <span>启用流式请求（Stream）</span>
        </label>
        <div id="streamHint" class="models-hint">部分渠道在流式模式下表现更佳，建议开启</div>
      </div>

      <div class="form-group">
        <label class="form-label" for="testConcurrency">
          批量测试并发数
          <span class="models-hint" style="margin-left: 8px;">同时测试的Key数量（建议5-20）。冷却策略由服务器端自动应用（指数退避：2min→4min→8min→30min）</span>
        </label>
        <input type="number" id="testConcurrency" class="form-input" value="10" min="1" max="50" style="width: 150px;">
      </div>
      
      <!-- 测试进度 -->
      <div id="testProgress" class="test-progress">
        <div class="test-spinner"></div>
        <span id="testProgressText">正在测试API连接...</span>
      </div>

      <!-- 批量测试进度 -->
      <div id="batchTestProgress" style="display: none; margin-top: 16px; padding: 16px; background: var(--neutral-50); border-radius: 8px; border: 1px solid var(--neutral-200);">
        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
          <span style="font-weight: 600; color: var(--neutral-700);">批量测试进度</span>
          <span id="batchTestCounter" style="color: var(--neutral-600);">0 / 0</span>
        </div>
        <div style="width: 100%; height: 8px; background: var(--neutral-200); border-radius: 4px; overflow: hidden;">
          <div id="batchTestProgressBar" style="width: 0%; height: 100%; background: linear-gradient(90deg, var(--primary-500), var(--primary-600)); transition: width 0.3s;"></div>
        </div>
        <div id="batchTestStatus" style="margin-top: 8px; font-size: 13px; color: var(--neutral-600);"></div>
      </div>
      
      <!-- 测试结果 -->
      <div id="testResult" class="test-result">
        <div id="testResultContent"></div>
        <div id="testResultDetails" class="test-details"></div>
      </div>
      
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="closeTestModal()">关闭</button>
        <button type="button" id="runTestBtn" class="btn btn-primary" onclick="runChannelTest()">单个测试</button>
        <button type="button" id="batchTestBtn" class="btn btn-primary" onclick="runBatchTest()" style="display: none;">批量测试所有Key</button>
      </div>
    </div>
  </div>

  <!-- Key导入模态框 -->
  <div id="keyImportModal" class="modal">
    <div class="modal-content" style="max-width: 600px;">
      <div class="modal-header">
        <h2 class="modal-title">批量导入 API Keys</h2>
        <button class="close-btn" onclick="closeKeyImportModal()" style="width: 28px; height: 28px; border-radius: 50%; border: none; background: var(--neutral-100); color: var(--neutral-600); cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; padding: 0;" onmouseover="this.style.background='var(--neutral-200)'" onmouseout="this.style.background='var(--neutral-100)'">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10.5 3.5L3.5 10.5M3.5 3.5L10.5 10.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
      <div style="padding: 20px;">
        <div class="form-group" style="margin-bottom: 12px;">
          <label class="form-label" style="margin-bottom: 8px;">粘贴API Keys <span style="color: var(--neutral-500); font-size: 13px; font-weight: normal;">(支持逗号或换行分隔)</span></label>
          <textarea
            id="keyImportTextarea"
            class="form-input"
            rows="10"
            placeholder="sk-ant-key1,sk-ant-key2&#10;sk-ant-key3&#10;sk-ant-key4"
            style="resize: vertical; min-height: 200px; font-family: 'Monaco', 'Menlo', 'Courier New', monospace; font-size: 13px;"
          ></textarea>
        </div>
        <div style="padding: 12px; background: var(--info-50); border: 1px solid var(--info-500); border-radius: 6px; color: var(--neutral-700); font-size: 13px; margin-bottom: 16px;">
          <div style="display: flex; align-items: flex-start; gap: 8px;">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0; margin-top: 2px;">
              <circle cx="8" cy="8" r="6.5" stroke="currentColor" stroke-width="1.5"/>
              <path d="M8 5V8.5M8 11H8.005" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <div>
              <strong>使用说明：</strong>
              <ul style="margin: 6px 0 0 0; padding-left: 16px; line-height: 1.6;">
                <li>支持逗号分隔：<code style="background: rgba(0,0,0,0.05); padding: 2px 4px; border-radius: 3px;">key1,key2,key3</code></li>
                <li>支持换行分隔：每行一个Key</li>
                <li>自动去除空格、空行和重复Key</li>
              </ul>
            </div>
          </div>
        </div>
        <div id="keyImportPreview" style="display: none; margin-bottom: 16px;">
          <div style="padding: 12px; background: var(--success-50); border: 1px solid var(--success-500); border-radius: 6px; color: var(--success-600);">
            <div style="display: flex; align-items: center; gap: 8px; font-weight: 600;">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 8L6.5 11.5L13 5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>解析成功：将导入 <span id="keyImportCount">0</span> 个Key</span>
            </div>
          </div>
        </div>
      </div>
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" onclick="closeKeyImportModal()">取消</button>
        <button type="button" class="btn btn-primary" onclick="confirmInlineKeyImport()">确认导入</button>
      </div>
    </div>
  </div>


  <script src="/web/assets/js/channels.js"></script>
  <script src="/web/assets/js/ui.js"></script>
</body>
</html>
